---
title: "COMPUTER PRACTICE 4.Exploratory  data analysis in R"
author: "Ivan Gercev"
date: "06 April 2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
  html_notebook: default
subtitle: COMPUTER PRACTICE 4
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.height=4) 

```
# Data processing
## installing the requirements
```{r}
packages <- c("qcc", "dplyr", "tidyr","knitr")
install.packages(setdiff(packages, rownames(installed.packages()))) 
library(knitr)
library(qcc)
library(dplyr)
library(tidyr)
```

## Data downloading from the source
```{r}


if (!file.exists("wine_data.csv")) {
  id <- "17SRO5g0Ho1GWHFwfYtYSoMlGlMJBdd7o" # google file ID
  
  download.file(
    sprintf("https://docs.google.com/uc?id=%s&export=download", id),
    destfile = "wine_data.csv",
    noprogress = TRUE
  )
  
}
 
```
## Read data set file

```{r}
wine_table <- read.csv("wine_data.csv",header=T ,sep = ",")
kable(head(wine_table), caption ="Wine Reviews")
```

# Descriptive statistics 
```{r}
kable(summary(wine_table), caption ="Summary statistics")

```
```{r}
samplesAmount = nrow(wine_table)
samplesAmount
```
Number of samples `r samplesAmount`

# Descriptive statistics for points of wine
```{r}
df = data.frame(unclass(summary(wine_table$points)))
colnames(df)<-c("points")
kable(df,caption ="5-number statistics (Rooms)")

```
```{r}
plot(ecdf(wine_table$points), main="Empirical cumulative distribution function (points)")
```
```{r}
kable(table(wine_table$points),caption ="Absolute frequencies (Rooms)")

```

```{r}

hist(wine_table$points, main="Histogram (points)")

```
```{r}
n = nrow(wine_table)
wj = table(wine_table$points)/n
kable(round(wj, digits=3),caption ="Relative frequencies (points)")

```

```{r}

plot(ecdf(wine_table$points), main="Empirical cumulative distribution function (points)")

plot(wj, type="b", main="Distribution (Points)")

boxplot(wine_table$points, main="Box-and-whisker plot (Points)")

```

```{r}
df = data.frame(unclass(summary(wine_table$price)))
colnames(df)<-c("Price")
kable(df,caption ="5-number statistics (Price)")
```
```{r}

boxplot(wine_table$price, main="Box-and-whisker plot (Price)")

```

```{r}

pareto.chart(wj/samplesAmount, main="Pareto Chart (Type)")

```
```{r}
table(wine_table$country)


```

